{% extends 'analysis_viz/base.html' %}
{% load static %}

{% block title %}Contesto del Progetto: Protein Dynamics{% endblock %}

{% block extra_css %}
<style>
    .box { background: var(--card-bg); padding: 30px; border-radius: 8px; box-shadow: 0 4px 6px var(--shadow-color); margin-bottom: 30px; border: 1px solid var(--border-color); }
    .highlight { font-weight: bold; color: var(--accent-color); background-color: rgba(52, 152, 219, 0.1); padding: 2px 5px; border-radius: 3px; }
    h2 { color: var(--accent-color); margin-top: 40px; border-left: 5px solid var(--accent-color); padding-left: 10px; margin-bottom: 20px; }
    h3 { color: var(--text-color); margin-top: 25px; margin-bottom: 15px; opacity: 0.95; font-weight: 600; }
    
    ul { list-style-type: none; padding-left: 0; }
    li { margin-bottom: 15px; font-size: 1.05em; padding-left: 20px; border-left: 3px solid var(--border-color); }
    li strong { color: var(--accent-color); }
    
    p { line-height: 1.6; font-size: 1.05em; margin-bottom: 20px; color: var(--text-color); }
    
    table { width: 100%; border-collapse: collapse; font-family: monospace; font-size: 0.9em; background: var(--card-bg); margin-bottom: 20px; }
    th { padding: 10px; border: 1px solid var(--border-color); background-color: var(--header-bg); color: var(--header-text); }
    td { padding: 8px; border: 1px solid var(--border-color); color: var(--text-color); }

    .nav-arrow {
        position: fixed;
        top: 50%;
        transform: translateY(-50%);
        background-color: var(--card-bg);
        color: var(--accent-color);
        width: 50px;
        height: 50px;
        border-radius: 50%;
        box-shadow: 0 4px 10px var(--shadow-color);
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 24px;
        text-decoration: none;
        border: 2px solid var(--accent-color);
        transition: all 0.3s;
        z-index: 100;
    }
    .nav-arrow:hover {
        background-color: var(--accent-color);
        color: white;
        transform: translateY(-50%) scale(1.1);
    }
    .nav-arrow.left { left: 20px; }
    .nav-arrow.right { right: 20px; }
</style>
{% endblock %}

{% block content %}
    <!-- Floating Navigation Arrows -->
    <a href="/" class="nav-arrow left" title="Torna alla Dashboard">&larr;</a>
    <a href="/step1" class="nav-arrow right" title="Vai allo Step 1">&rarr;</a>

    <div style="text-align: center; margin-bottom: 30px;">
        <h1 style="color: var(--accent-color);">Step 0: Il Contesto Scientifico e il Meccanismo</h1>
    </div>
    
    <!-- 1. Che cos'è la Dinamica Molecolare -->
    <div class="box">
        <h2>1. Il Problema e l'Obiettivo</h2>
        
        <h3>Che cos'è la Dinamica Molecolare (MD)?</h3>
        <p>Le simulazioni MD sono metodi computazionali che analizzano il comportamento fisico di proteine e biomolecole ad alta risoluzione temporale. Immaginale come un <strong>"film"</strong> che mostra come si muove una proteina a livello atomico.</p>
        <ul>
            <li><strong>Il Processo Classico:</strong> La simulazione risolve le equazioni del moto di Newton per ogni atomo ogni 2 femtosecondi (un tempo infinitesimale, 10<sup>-15</sup> secondi).</li>
            <li><strong>Il Collo di Bottiglia:</strong> Calcolare forze e velocità per ogni atomo ogni 2 femtosecondi è estremamente lento e richiede un'enorme potenza di calcolo (O(N<sup>2</sup>)).</li>
        </ul>

        <h3>L'Obiettivo del Deep Learning</h3>
        <p>L'obiettivo è creare un modello di <strong>Deep Learning</strong> capace di effettuare una previsione dipendente dal tempo delle matrici di forza, velocità e coordinate.</p>
        <p>Invece di calcolare tutto fisicamente passo dopo passo, l'AI impara a "prevedere" il movimento futuro, permettendo di aggiornare le posizioni degli atomi molto più velocemente.</p>
    </div>

    <!-- 2. I Dati e il Meccanismo -->
    <div class="box">
        <h2>2. I Dati e il Meccanismo di Predizione</h2>
        
        <h3>I Dati (Input)</h3>
        <p>Per ogni "passo temporale" (time-step), la simulazione lavora su tre matrici di lunghezza 3N (dove N è il numero di atomi):</p>
        <ul>
            <li><strong>Coordinate (X):</strong> La posizione nello spazio (x, y, z) di ogni atomo.</li>
            <li><strong>Forze (F):</strong> La forza che agisce su ogni atomo nelle tre direzioni.</li>
            <li><strong>Velocità (V):</strong> La direzione e la rapidità del movimento.</li>
        </ul>

        <h3>La Sfida: Time Series Forecasting</h3>
        <p>Stiamo affrontando un problema di previsione di serie temporali. Immagina il dataset come una sequenza di frame video.</p>
        
        <h4>Rappresentazione Tabellare del Processo (Input &rarr; Output)</h4>
        <p>Ecco concretamente cosa "vede" la rete neurale. Forniamo una finestra di 10 frame passati (<i>t</i><sub>-9</sub> ... <i>t</i><sub>0</sub>) per predire il frame futuro (<i>t</i><sub>+1</sub>).</p>

        <div style="overflow-x: auto; margin-bottom: 20px;">
            <table>
                <thead>
                    <tr>
                        <th colspan="5">INPUT: Finestra Temporale (es. 10 frame passati)</th>
                    </tr>
                    <tr>
                        <td style="background-color: var(--bg-color); font-weight: bold;">Tempo</td>
                        <td style="background-color: var(--bg-color);">Atomo 1 (x,y,z)</td>
                        <td style="background-color: var(--bg-color);">Atomo 2 (x,y,z)</td>
                        <td style="background-color: var(--bg-color);">...</td>
                        <td style="background-color: var(--bg-color);">Atomo 138 (x,y,z)</td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="font-weight: bold;">t<sub>-9</sub></td>
                        <td>[0.5, 1.2, -0.3]</td>
                        <td>[2.1, 0.0, 1.1]</td>
                        <td>...</td>
                        <td>[-0.1, 3.2, 0.5]</td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold;">t<sub>-8</sub></td>
                        <td>[0.5, 1.3, -0.2]</td>
                        <td>[2.2, 0.1, 1.0]</td>
                        <td>...</td>
                        <td>[-0.2, 3.1, 0.6]</td>
                    </tr>
                    <tr>
                        <td colspan="5" style="text-align: center;">... (altri 7 frame) ...</td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold; color: var(--accent-color);">t<sub>0</sub> (Oggi)</td>
                        <td>[0.7, 1.5, 0.1]</td>
                        <td>[2.4, 0.3, 0.9]</td>
                        <td>...</td>
                        <td>[-0.3, 3.0, 0.9]</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div style="text-align: center; margin: 20px 0; font-size: 2em; color: var(--text-color);">&darr; <i>La Rete Neurale elabora...</i> &darr;</div>

        <div style="overflow-x: auto;">
            <table>
                <thead>
                    <tr>
                        <th colspan="5" style="border: 2px solid #e74c3c; border-bottom: none;">OUTPUT: Predizione (Prossimo istante)</th>
                    </tr>
                    <tr>
                        <td style="background-color: var(--bg-color); font-weight: bold;">Tempo</td>
                        <td style="background-color: var(--bg-color);">Atomo 1 (x,y,z)</td>
                        <td style="background-color: var(--bg-color);">Atomo 2 (x,y,z)</td>
                        <td style="background-color: var(--bg-color);">...</td>
                        <td style="background-color: var(--bg-color);">Atomo 138 (x,y,z)</td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="font-weight: bold; color: #e74c3c;">t<sub>+1</sub> (Futuro)</td>
                        <td><b>[0.8, 1.6, 0.2]</b></td>
                        <td><b>[2.5, 0.4, 0.8]</b></td>
                        <td>...</td>
                        <td><b>[-0.4, 2.9, 1.0]</b></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- 3. Le Sfide Tecniche -->
    <div class="box">
        <h2>3. Le Sfide Tecniche</h2>
        <p>Per realizzare questo modello, dobbiamo superare quattro ostacoli principali:</p>
        <ul>
            <li><strong>Riduzione della Dimensionalità:</strong> Dati enormi (centinaia di variabili). Dobbiamo comprimere l'informazione senza perdere i dettagli vitali.</li>
            <li><strong>Ottimizzazione della Finestra Temporale:</strong> Trovare il giusto compromesso "memoria vs velocità". Quanti frame passati servono davvero?</li>
            <li><strong>Super Risoluzione:</strong> Passare da dati a bassa risoluzione temporale (pochi frame) a previsioni ad alta risoluzione (film fluido).</li>
            <li><strong>Spiegabilità (Explainability):</strong> Usare le <em>Attention Maps</em> per capire "dove guarda" il modello. Non basta indovinare, dobbiamo fidarci della fisica appresa.</li>
        </ul>
    </div>

    <!-- 4. I Modelli Specifici (RNN & CNN) -->
    <div class="box">
        <h2>4. Gli Strumenti: RNN e CNN</h2>
        <p>Usiamo due architetture diverse per catturare aspetti diversi del movimento:</p>

        <h3>A. RNN (Recurrent Neural Network) – La Memoria Sequenziale</h3>
        <p>Processa i frame uno alla volta (<i>t</i><sub>-9</sub> &rarr; <i>t</i><sub>-8</sub>...).</p>
        <ul>
            <li><strong>Ruolo:</strong> Capisce l'inerzia e la direzione. "Se si muove a destra da 5 frame, continuerà a destra."</li>
        </ul>

        <h3>B. CNN 1D (Convolutional Neural Network) – I Pattern Locali</h3>
        <p>Osserva l'intera finestra temporale in un colpo solo.</p>
        <ul>
            <li><strong>Ruolo:</strong> Rileva eventi specifici (es. una vibrazione improvvisa) indipendentemente da quando avvengono.</li>
        </ul>
    </div>

    <!-- 5. Roadmap -->
    <div class="box">
        <h2>5. Roadmap Pratica</h2>
        <ul>
            <li><strong>Pre-processing:</strong> Pulizia dati, rimozione timestamp, normalizzazione.</li>
            <li><strong>Implementazione:</strong> Creazione e training di CNN 1D e RNN (6 CFU).</li>
            <li><strong>Validazione:</strong> Test iperparametri, confronto finestre temporali, analisi errori.</li>
        </ul>
    </div>

    <!-- 6. Contesto Clinico e Impatto -->
    <div class="box" style="border-left: 5px solid #27ae60;">
        <h2 style="border: none; margin-top: 10px; padding-left: 0; color: #27ae60;">6. Il Contesto Clinico e l'Impatto Reale</h2>
        
        <h3>Chi è il bersaglio?</h3>
        <p><strong>Non stiamo simulando il farmaco, ma il bersaglio (Target).</strong></p>
        <p>Le coordinate e le forze descrivono una proteina "malata" (es. tumorale) che continua a muoversi ("ballare"). I chimici devono progettare un farmaco che riesca ad incastrarsi in questa proteina ballerina.</p>

        <h3>Le Conseguenze dell'Errore</h3>
        <p>Se la nostra previsione di questo "ballo" è sbagliata:</p>
        <ul>
            <li><strong>Farmaci Inefficaci:</strong> Il farmaco viene disegnato per una forma che la proteina non assume mai nella realtà.</li>
            <li><strong>Effetti Collaterali:</strong> La simulazione fallisce nel mostrare configurazioni pericolose della proteina ch interagiscono con altre molecole vitali.</li>
            <li><strong>Spreco di Risorse:</strong> Anni di ricerca buttati su molecole che funzionano solo "al computer" ma non nella realtà fisica.</li>
        </ul>
    </div>

{% endblock %}
